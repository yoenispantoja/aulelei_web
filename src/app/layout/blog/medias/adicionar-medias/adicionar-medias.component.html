<div [@routerTransition]>
    <app-page-header [heading]="'Adicionar medias'" [icon]="'fa-pencil-square'"></app-page-header>
    <div class="row">
        <div class="col-9">
            <div ng2FileDrop [ngClass]="{ 'nv-file-over': hasBaseDropZoneOver }" (fileOver)="fileOverBase($event)" [uploader]="uploader" (onFileDrop)="onFileSelected($event)" class="well my-drop-zone">
                Arrastre y suelte las imágenes aquí
            </div>
        </div>
        <div class="col-3 align-self-center">
            <div class="btnCargarArchivos">
                <button type="button" class="btn btn-primary" (click)="fileInput.click()">
          <i class="fa fa-image"></i> O seleccione los archivos
        </button>
                <input hidden #fileInput type="file" ng2FileSelect [uploader]="uploader" multiple (onFileSelected)="onFileSelected($event)" />
            </div>
            <br /><br />
            <strong class="totalImagenes">Total de imágenes: {{ uploader?.queue?.length }}</strong
      >
    </div>
  </div>
  <br />
  <ng-container *ngIf="uploader.queue.length > 0">
    <div class="row">
      <div class="col-12">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th width="110px">Imagen</th>
              <th width="20%">Nombre</th>
              <th>Tamaño</th>
              <th>Progreso</th>
              <th>Estado</th>
              <th width="15%">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of uploader.queue">
              <td>
                <img
                  src=""
                  imgPreview
                  [image]="item?._file"
                  class="imageTabla"
                />
              </td>
              <td>
                <strong>{{ item?.file?.name }}</strong>
            </td>
            <td>{{ item?.file?.size / 1024 / 1024 | number: ".2" }} MB</td>
            <td>
                <div class="progress" style="margin-bottom: 0;">
                    <div class="progress-bar" role="progressbar" [ngStyle]="{ width: item.progress + '%' }"></div>
                </div>
            </td>
            <td class="text-center">
                <span *ngIf="item.isSuccess"><i class="fa fa-check-circle"></i
                ></span>
                <span *ngIf="item.isError"><i class="fa fa-remove"></i></span>
            </td>
            <td nowrap class="botonesFila">
                <button type="button" class="btn btn-success btn-sm" (click)="item.upload()" [disabled]="
                    item.isReady || item.isUploading || item.isSuccess
                  ">
                  <span class="fa fa-upload"></span> Subir
                </button>
                <button type="button" class="btn btn-danger btn-sm" (click)="item.remove()">
                  <span class="fa fa-trash"></span> Eliminar
                </button>
            </td>
            </tr>
            </tbody>
            </table>
        </div>
    </div>
    <br />
    <div class="row">
        <div class="col-12">
            <div class="progress progress-bar" role="progressbar" [ngStyle]="{ width: uploader.progress + '%' }"></div>
        </div>
    </div>
    <br />
    <div class="row justify-content-end">
        <div class="col-6 botonesGenerales">
            <button type="button" class="btn btn-success btn-s" (click)="uploader.uploadAll()" [disabled]="!uploader.getNotUploadedItems().length">
          <span class="fa fa-upload"></span> Subir todas
        </button>
            <button type="button" class="btn btn-danger btn-s" (click)="uploader.clearQueue()" [disabled]="!uploader.queue.length">
          <span class="fa fa-trash"></span> Eliminar todas
        </button>
        </div>
    </div>
    </ng-container>
</div>
<br /><br />

<swal #confirmSwal title="Información" text="Las imágenes han sido subidas correctamente" type="success" [showCancelButton]="false" [focusCancel]="true" (confirm)="cerrarVentana()">
</swal>